#!/bin/bash

CONFIG_FILE="$HOME/dotfiles/scripts/backup/config.json"
BACKUP_SCRIPT="$HOME/dotfiles/scripts/backup/repo.sh"

if ! command -v jq &> /dev/null; then
    echo "‚ùå ERROR: jq is not installed. Please install it to continue."
    exit 1
fi

REPO_NAMES=$(jq -r '.repositories[].name' "$CONFIG_FILE")

for repo_name in $REPO_NAMES; do
    echo "--- Starting backup for $repo_name ---"
    /bin/bash "$BACKUP_SCRIPT" "$repo_name"
    echo "--- Finished backup for $repo_name ---"
done